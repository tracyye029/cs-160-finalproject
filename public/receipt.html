<!-- Starter code for Final Project Accountability!-->
<!-- for CS160 User Interface Design & Development Summer 2022 at UC Berkeley-->

<!DOCTYPE html>
<html>
  <head>
    <!-- add Bootstrap 4 (from https://getbootstrap.com/docs/4.0/getting-started/download/)-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />

    <!-- add jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!--add the Google Material Symbols Font (from https://fonts.google.com/icons ) -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />

    <!-- add jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/style.css" />
    <link rel="stylesheet" type="text/css" href="/css/receipt.css" />

    <!--add the Google Material Symbols Font (from https://fonts.google.com/icons ) -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
  </head>

  <body style="background-color: #273F3A">  
    <div class="header">
        <div class="back-icon">
          <a href="/home.html">
            <img src="/img/ui_icons/back.svg" width="25px"; height="auto">
          </a>
        </div>
        <div class="title">Scan or Upload Your Receipt</div> 
    </div>


    <div id="video-container">
        <video autoplay="true" id="video-element">
        </video>
    </div>
    <div class="bottom-bar">
        <button id="stop" class="camera-button" onclick="location.href='/receipt_load.html'">
            <img src="img/ui_icons/image_gallery.svg" height="145%" width="145%" style="background-color: #273F3A;"/>
        </button>

        <button id="stop" class="camera-button" onclick="location.href='/receipt_load.html'">
            <img src="img/ui_icons/camera_button.svg" height="145%" width="145%" style="background-color: #273F3A;"/>
        </button>
    </div>

    <!-- Camera Functionality from https://www.kirupa.com/html5/accessing_your_webcam_in_html5.htm-->>
    <script>
        var video = document.querySelector("#video-element");
        var stopVideo = document.querySelector("#stop");

        if (navigator.mediaDevices.getUserMedia) {
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(function (stream) {
            video.srcObject = stream;
            })
            .catch(function (err0r) {
            console.log("Something went wrong!");
            });
        }
        
        stopVideo.addEventListener("click", stop, false)

        function stop(e) {
            var stream = video.srcObject;
            var tracks = stream.getTracks();

            for (var i = 0; i < tracks.length; i++) {
                var track = tracks[i];
                track.stop();
            }

            video.srcObject = null;
            console.log("Should stop");
            window.location.replace("/receipt_load.html");
        }
    </script>
  </body>
</html>
